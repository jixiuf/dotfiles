# https://github.com/k0kubun/xremap
# key 的名字参见
# https://github.com/emberian/evdev/blob/1d020f11b283b0648427a2844b6b980f1a268221/src/scancodes.rs#L26-L572
# sudo systemctl restart xremap
# super = cmd on macos and win on windows
# journalctl -u xremap
keymap:
  - name: swappy
    application:
      only: [swappy]
    remap:
    # http://7is7.com/software/firefox/shortcuts.html
      C-y: C-y
      C-b: C-b
      C-g: [C-c,C-s, esc]
      esc: [C-c,C-s, esc]
      C-slash: C-z
      C-x:
        remap:
          C-c: [C-c,C-s, esc]
  - name: DBeaver
    application:
      only: [DBeaver]
    remap:
    # http://7is7.com/software/firefox/shortcuts.html
      C-r: F5
      C-s: C-s

  - name: firefox
    application:
      only: [firefox,firefox-esr]
    remap:
    # http://7is7.com/software/firefox/shortcuts.html
      M-backspace: C-Backspace
      C-u: C-Shift-t
      C-i: C-Shift-i
      C-comma: C-Pageup
      C-dot: C-Pagedown
      C-r: C-r
      # C-7: C-Shift-l
      C-h: M-left
      C-l: M-right
      C-o: C-l
      C-n: down
      C-p: up
      C-f: right
      C-b: left
      C-v: pagedown
      M-v: pageup
  - name: Google Chrome
    application:
      only: [Google-chrome,google-chrome]
    remap:
      M-backspace: C-Backspace
      Super-C-u: C-Shift-t
      C-comma: C-Shift-tab
      C-dot: C-tab
      C-r: C-r
      C-h: M-left
      C-l: M-right
      C-o: C-l
      C-n: down
      C-p: up
      C-f: right
      C-b: left
      C-a: Home
      C-e: End
      M-f: C-right
      M-b: C-left
      Super-M-f: Super-C-right
      Super-M-b: Super-C-left
      # Super-C-f: Super-C-f      #否则会变成 Super-right,因上面 C-f->right
      Super-C-b: Super-C-b
      Super-C-a: C-a
      Super-C-w: C-f4           # close tab

  - name: Emacs
    application:
      only: [emacs,Emacs]
    remap:
      C-Space: Super-C-Space
      C-g: [Super-Space,f15]
      # C-x: C-x
      Super-C-g: Super-C-g
      Super-C-t: { launch: ["hyprctl","dispatch","dispatch","exec  hypr-run-or-raise --cd --floating-only -- dterm alacritty  --working-directory=$(hypr-cwd||echo $HOME) --class=dterm "] }

  - name: dterm                 # dropdown terminal by alacritty
    application:
      only: [dterm]
    remap:
    # 对于 dropdown 形式的 alacritty,spacebar-enter 时，先将当前 term 转成平铺窗口
    # 然后再使用 alacritty 的 SpawnNewInstance 重新打开一个 class=dterm 的窗口
    # 这个新窗口根据 swaywm 的规则，必是 floating 的
      # Super-M-f: { launch: ["hyprctl","dispatch","floating toggle"] }
      Super-C-Enter:
        - { launch: ["hyprctl","dispatch","dispatch togglefloating"] }
        - Shift-C-Enter

  - name: Terminal
    application:
      only: [dterm,Alacritty,alacritty]
    remap:
      C-2: C-Shift-Space        # Alacritty vi mode,v:select,i: quit
      Super-C-Enter: Shift-C-Enter # new  Alacritty in pwd
      Super-C-w: Super-C-q
      Super-C-v: C-y
      Super-C-c: C-Shift-c
      Super-C-t: { launch: ["hypr-run-or-raise", "--cd","--floating-only","--","dterm","alacritty  --working-directory=$(hypr-cwd||echo $HOME) --class=dterm "] }
      C-Enter: [C-y,Enter]
      C-x:
        remap:
          C-x: C-x              # C-xC-x send C-x
          C-c: Super-C-q
      C-c:
        remap:
          C-c: C-c              # C-xC-x send C-x
          C-e: C-Shift-M        # hints
          C-j: { launch: ["open-with"]}


  - name: global_emacs
    application:
      only: [DBeaver,apifox-pdv]
    remap:
      C-b: left
      C-n: down
      C-p: up
      C-a: home
      C-e: end
      C-f: right
      C-d: delete
  - name: Default -- some of these are overridden by the above definitions
    application:
      not: [Gnome-terminal, Emacs,emacs ,foot,Foot,dterm,Alacritty,alacritty]
      # not: [Google-chrome, Slack, Gnome-terminal, jetbrains-idea,emacs]
    remap:
      Super-C-a: C-a
      Super-C-c: C-c
      Super-C-v: C-v
      Super-C-z: C-z
      Super-C-s: C-s
      # C-x: Super-C-M-x
      # Super-C-x: [Super-C-M-x,C-x]
      # C-M-x: C-M-x
      # Super-M-x: Super-M-x
      # Cursor
      # Newline
      C-m: enter
      C-o: [enter, left]
      # Copy
      # C-w: [C-x, { set_mark: false }]
      M-w: [C-c, { set_mark: false }]
      # C-y: [C-v, { set_mark: false }]
      # Delete
      M-d: [C-delete, { set_mark: false }]
      # Kill line
      C-k: [Shift-end, C-x, { set_mark: false }]
      # Undo
      C-slash: [C-z, { set_mark: false }]
      # Mark
      # C-2: { set_mark: true }
      C-g: [esc, { set_mark: false }]
      # C-x YYY
      C-x:
        remap:
          C-x: C-x              # C-xC-x send C-x
          # C-x h (select all)
          h: [C-home, C-a, { set_mark: true }]
          # C-x C-f (open)
          C-f: C-o
          # C-x C-s (save)
          C-s: C-s
          # C-x k (kill tab)
          k: C-f4
          # C-x C-c (exit)
          C-c: Super-C-q

  - name: Global
    remap:
    # 使用 hyprctl exec 执行的命令，重启 xremap 不会导致这些程序也跟着重启
      Super-C-e: { launch: ["hyprctl","dispatch","exec","hypr-run-or-raise","emacs","runemacs"] }
      Super-C-f: { launch: ["hyprctl","dispatch","exec","hypr-run-or-raise","'firefox|firefox-esr'","firefox"] }
      Super-C-5: { launch: ["hyprctl","dispatch","exec", "hypr-run-or-raise","apifox-pdv","/opt/Apifox/apifox-pdv"] }
      Super-C-6: { launch: ["hyprctl","dispatch","exec","hypr-run-or-raise","DBeaver","dbeaver"] }
      Super-C-j: { launch: ["hyprctl","dispatch","exec","hypr-run-or-raise mitp alacritty -- --class=mitp -e mitmproxy -p 8888"] }
      Super-C-d: { launch: ["hyprctl","dispatch","exec","hypr-run-or-raise --floating-only dterm alacritty  -- --working-directory=$(hypr-cwd||echo $HOME) --class=dterm "] }
      Super-C-comma: { launch: ["hyprctl","dispatch","exec","hypr-run-or-raise --floating-only dterm alacritty  -- --working-directory=$(hypr-cwd||echo $HOME) --class=dterm "] }
      Super-C-b: { launch: ["hyprctl","dispatch","exec","hypr-run-or-raise weixin weixin-uos" ] }
      Super-C-3: { launch: ["hyprctl","dispatch","exec","hypr-run-or-raise","Bytedance-feishu","bytedance-feishu-stable  2>&1 >/dev/null"] }
      Super-C-g: { launch: ["hyprctl","dispatch","exec","hypr-run-or-raise org.gnome.Nautilus nautilus"] }
      # eme slurp swappy
      Super-C-4: { launch: ["sh","-c","grim -g \"$(slurp)\" - | swappy -f -"]}

      Super-C-7: { launch: ["swaylock","--ignore-empty-password", "--show-failed-attempts", "--color", "1e1e1e", "--inside-color", "cccccc" ,"--ring-color", "ffffff", "--inside-clear-color","11a8cd", "--ring-clear-color", "29b8db","--inside-ver-color", "2472c8", "--ring-ver-color", "3b8eea", "--inside-wrong-color","cd3131","--ring-wrong-color","f14c4c"] }
      Super-C-8: { launch: ["hyprctl","dispatch","exec","hypr-run-or-raise","corplink","/opt/Corplink/corplink"] }
      Super-C-9: { launch: ["pick-color"] }
      Super-C-y: { launch: ["run-bemenu-cliphist"] }
      Super-C-r: { launch: ["run-bemenu"] }
      C-Tab: { launch: ["wofi","--show","drun"] }
      Super-C-Enter: { launch: ["hyprctl","dispatch","exec", "alacritty --working-directory=$(hypr-cwd||echo $HOME)"] }
      Super-C-Backslash: { launch: ["hyprctl","dispatch","togglesplit"] }
      Super-M-f: { launch: ["hyprctl","dispatch","togglefloating"] }
      Super-M-h: { launch: ["hyprctl","dispatch","movetoworkspacesilent","special"] }
      Super-C-M-h: { launch: ["hyprctl","dispatch","togglespecialworkspace"] }

      Super-C-o: { launch: ["hyprctl","dispatch","cyclenext"] }
      Super-C-1: { launch: ["hypr-kill-other-window"] }
      Super-C-m: { launch: ["hyprctl","dispatch","fullscreen","1"] }
      Super-M-m: { launch: ["hyprctl","dispatch","fullscreen","0"] }
      Super-C-w: Super-C-w
      Super-C-n: { launch: ["hyprctl","dispatch" ,"workspace","r+1"]}
      Super-C-p: { launch: ["hyprctl","dispatch" ,"workspace","r-1"]}
      Super-C-right: { launch: ["hyprctl" ,"dispatch","resizeactive","10","0"]}
      Super-C-left: { launch: ["hyprctl" ,"dispatch","resizeactive","-10","0"]}
      Super-C-up: { launch: ["hyprctl" ,"dispatch","resizeactive","0","-10"]}
      Super-C-down: { launch: ["hyprctl" ,"dispatch","resizeactive","0","10"]}

      C-w:
        remap:
          C-w: C-w              # C-wC-w send C-w
          Enter: Super-C-Backslash
          C-r: Super-M-r        # reload
          C-o: Super-C-o
          o: Super-C-o
          "1": { launch: ["hyprctl" ,"dispatch","movetoworkspace","1"]}
          "2": { launch: ["hyprctl" ,"dispatch","movetoworkspace","2"]}
          "3": { launch: ["hyprctl" ,"dispatch","movetoworkspace","3"]}
          "4": { launch: ["hyprctl" ,"dispatch","movetoworkspace","4"]}
          "5": { launch: ["hyprctl" ,"dispatch","movetoworkspace","5"]}
          "6": { launch: ["hyprctl" ,"dispatch","movetoworkspace","6"]}
          "7": { launch: ["hyprctl" ,"dispatch","movetoworkspace","7"]}
          "8": { launch: ["hyprctl" ,"dispatch","movetoworkspace","8"]}
          "9": { launch: ["hyprctl" ,"dispatch","movetoworkspace","9"]}
          "0": { launch: ["hyprctl" ,"dispatch","movetoworkspace","10"]}
          "C-1": { launch: ["hyprctl" ,"dispatch","movetoworkspace","1"]}
          "C-2": { launch: ["hyprctl" ,"dispatch","movetoworkspace","2"]}
          "C-3": { launch: ["hyprctl" ,"dispatch","movetoworkspace","3"]}
          "C-4": { launch: ["hyprctl" ,"dispatch","movetoworkspace","4"]}
          "C-5": { launch: ["hyprctl" ,"dispatch","movetoworkspace","5"]}
          "C-6": { launch: ["hyprctl" ,"dispatch","movetoworkspace","6"]}
          "C-7": { launch: ["hyprctl" ,"dispatch","movetoworkspace","7"]}
          "C-8": { launch: ["hyprctl" ,"dispatch","movetoworkspace","8"]}
          "C-9": { launch: ["hyprctl" ,"dispatch","movetoworkspace","9"]}
          "C-0": { launch: ["hyprctl" ,"dispatch","movetoworkspace","10"]}

          C-e:  { launch: ["hyprctl" ,"dispatch","movetoworkspace","empty"]}
          C-f: { launch: ["hyprctl" ,"dispatch","movetoworkspace","r+1"]}
          C-b: { launch: ["hyprctl" ,"dispatch","movetoworkspace","r-1"]}
